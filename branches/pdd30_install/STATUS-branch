DESCRIPTION
-----------

This branch has almost nothing to do with the cygwin architecture.  It
was named "cygwin070patches" because it contains all the patches from
the cygwin 0.7.0 release package.

It really is a "pdd30_install" branch and contains the following
patches:

  39742-installed-conflict.patch
  56544-install_files.patch
  57006-opengl-cyg.patch -p0
  58034-config_args.patch
  56554-make-install-lang.patch
  56998-cygdll_versioning.patch -p0
  51944-README_cygwin.patch -p0
  56996-fhs-runtime.patch
  57548-CONDITIONED_LINE_enh.patch
  58590-dotnet-make.patch


DETAILS
-------

Still working on fully fixing RT#39742 installed-conflict.
* libparrot_ldflags needs to point to the file and may not use 
  -L<blibpath> -lparrot, because /usr/lib is always before this 
  -L<blibpath>.

* cygwin went now the win32 way and puts its dll and importlib into
  build_dir and not into blib/lib. 
  #IF(cygwin or win32):LIBPARROT_SHARED    = @libparrot_shared@
  #ELSE:LIBPARROT_SHARED    = @blib_dir@/@libparrot_shared@
  So we need no SHRPENV PATH=...blib/lib:PATH
  overrides for every parrot and pbc_to_exe invocations (as in
  perl5). For the other unix-alikes with libparrot_shared we simply 
  export LD_RUN_PATH := @blib_dir@:..., as for darwin.

* mingw generates wrong destination paths. see below.
 
* msvc needs some more dllexport/dllimport attributes.

TODO
----

* add make uninstall support to core and languages (no ticket yet)

STATUS
-------
Of the cygwin070patches branch as of 2008-09-21 10:42:43 rurban

merging with trunk r31103 caused:
 * perl6: Null PMC access in get_bool() fixed with r31108.

cygwin + gcc 3.4.4
------------------
  make smoke + fulltest + languages + install basically ok
  (same languages failures as in trunk.)
  esp. for lua pbc_merge fails 


mingw + gcc 3.4.4
-----------------
same failures as in trunk:
* wrong readline detection in Configure, same as in trunk
  src\pmc\parrotio.o: In function `Parrot_ParrotIO_nci_readline':
    N:/usr/src/perl/parrot/cygwin070patches/src/pmc/parrotio.pmc:212: 
      undefined reference to `readline'
    N:/usr/src/perl/parrot/cygwin070patches/src/pmc/parrotio.pmc:219: 
      undefined reference to `add_history' 
  HAS_READLINE = 0
  readline = define
* wrong win32+mingw default prefix + install paths: libdir, bindir, 
  libexecdir, includedir, infodir, 
  mandir, docdir, htmldir, sbindir, shareddirstate, sysconfdir
  fix prefix: "/usr/local" => "<drive>:\parrot"


MSWin32 + MSVC6
---------------
Not tested with ActivePerl yet. 
With a mingw perl and cc+link overrides I couldn't pass make yet.


linux fc1 + perl 5.8.3
----------------------
Same blocker as in trunk: Too old Storable 2.09, which cannot overload stringify 
for hashes. Protected with C<use Storable 2.13;>

/usr/bin/perl /usr/src/parrot/cygwin070patches/tools/build/pmc2c.pl --c subproxy.pmc
Cannot restore overloading on HASH(0x81821a8) (package Parrot::Pmc2c::Emitter) at ../../lib/Storable.pm (autosplit into ../../lib/auto/Storable/_retrieve.al) line 323, at /usr/src/parrot/cygwin070patches/tools/build/dynpmc.pl line 204
gmake[1]: *** [all] Error 255
gmake[1]: Leaving directory `/usr/src/parrot/cygwin070patches/src/dynpmc'

linux fc1 + bleadperl
----------------------
  make smoke + fulltest + languages basically ok


freebsd 7 + gcc 4.2.1
---------------------
  make smoke + fulltest + languages basically ok

